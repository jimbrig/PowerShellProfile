<#
    .SYNOPSIS
        Exports the current Exploit Protection configuration to a file.
    .DESCRIPTION
        Exports the current Exploit Protection configuration to a file.
    .PARAMETER OutputPath
        The path to export the Exploit Protection configuration to.
        Defaults to `Desktop\ExploitProtectionConfig.xml` for the active user.
    .EXAMPLE
        Export-ExploitProtectionConfig -OutputPath "$env:USERPROFILE\Desktop\ExploitProtectionConfig.xml"
#>
Function Export-ExploitProtectionConfig {
    #Requires -RunAsAdministrator
    [CmdletBinding()]
    param(
        [string]$OutputPath = "$env:USERPROFILE\Desktop\ExploitProtectionConfig.xml"
    )

    try {
        Get-ProcessMitigation -RegistryConfigFilePath $OutputPath -ErrorAction Stop
        Write-Host "Exploit Protection configuration exported to $OutputPath" -ForegroundColor Green
    } catch {
        Write-Error "Failed to export Exploit Protection configuration: $_"
    }
}
